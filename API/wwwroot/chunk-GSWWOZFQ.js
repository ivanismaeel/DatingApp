import{a as k}from"./chunk-BTVUGZAX.js";import{a as fe,b as ge}from"./chunk-Y2SMNW46.js";import{b as ve,f as xe,g as ye,i as Ce,j as Fe,k as Se,v as Me}from"./chunk-EHQ3Q2RR.js";import{a as we,b as Ee,c as Ie}from"./chunk-3FYXDXPB.js";import{a as B}from"./chunk-FBW7R5MW.js";import"./chunk-IQ3DILG5.js";import{m as _e}from"./chunk-7W5VCNUX.js";import{c as be}from"./chunk-K5ZT4YFK.js";import"./chunk-TRHVLWE7.js";import{$b as l,Ba as j,Ca as G,Cb as z,Da as Z,Eb as ee,Fb as te,Fc as le,Gb as r,Gc as de,Hb as s,Hc as pe,Ib as _,Lc as me,Mb as I,Ob as f,Oc as ce,Pb as m,Pc as ue,Qc as he,Sb as T,Tb as ie,Yb as ne,Zb as oe,_a as P,_b as re,a as E,ac as C,bb as J,bc as V,cb as d,cc as se,dc as F,ec as S,fa as Q,fc as M,ib as X,ic as L,ka as x,kb as Y,lc as U,mc as N,nb as O,nc as ae,ob as K,pb as $,ra as c,sa as u,sb as y,ya as D,yb as h}from"./chunk-FY6FPK4F.js";var A=class{constructor(e){this.rawFile=e;let t=e instanceof HTMLInputElement?e.value:e;this[`_createFrom${typeof t=="string"?"FakePath":"Object"}`](t)}_createFromFakePath(e){this.lastModifiedDate=void 0,this.size=void 0,this.type=`like/${e.slice(e.lastIndexOf(".")+1).toLowerCase()}`,this.name=e.slice(e.lastIndexOf("/")+e.lastIndexOf("\\")+2)}_createFromObject(e){this.size=e.size,this.type=e.type,this.name=e.name}},R=class{constructor(e,t,i){this.url="/",this.headers=[],this.withCredentials=!0,this.formData=[],this.isReady=!1,this.isUploading=!1,this.isUploaded=!1,this.isSuccess=!1,this.isCancel=!1,this.isError=!1,this.progress=0,this.uploader=e,this.some=t,this.options=i,this.file=new A(t),this._file=t,e.options&&(this.method=e.options.method||"POST",this.alias=e.options.itemAlias||"file"),this.url=e.options.url}upload(){try{this.uploader.uploadItem(this)}catch{this.uploader._onCompleteItem(this,"",0,{}),this.uploader._onErrorItem(this,"",0,{})}}cancel(){this.uploader.cancelItem(this)}remove(){this.uploader.removeFromQueue(this)}onBeforeUpload(){}onBuildForm(e){return{form:e}}onProgress(e){return{progress:e}}onSuccess(e,t,i){return{response:e,status:t,headers:i}}onError(e,t,i){return{response:e,status:t,headers:i}}onCancel(e,t,i){return{response:e,status:t,headers:i}}onComplete(e,t,i){return{response:e,status:t,headers:i}}_onBeforeUpload(){this.isReady=!0,this.isUploading=!0,this.isUploaded=!1,this.isSuccess=!1,this.isCancel=!1,this.isError=!1,this.progress=0,this.onBeforeUpload()}_onBuildForm(e){this.onBuildForm(e)}_onProgress(e){this.progress=e,this.onProgress(e)}_onSuccess(e,t,i){this.isReady=!1,this.isUploading=!1,this.isUploaded=!0,this.isSuccess=!0,this.isCancel=!1,this.isError=!1,this.progress=100,this.index=void 0,this.onSuccess(e,t,i)}_onError(e,t,i){this.isReady=!1,this.isUploading=!1,this.isUploaded=!0,this.isSuccess=!1,this.isCancel=!1,this.isError=!0,this.progress=0,this.index=void 0,this.onError(e,t,i)}_onCancel(e,t,i){this.isReady=!1,this.isUploading=!1,this.isUploaded=!1,this.isSuccess=!1,this.isCancel=!0,this.isError=!1,this.progress=0,this.index=void 0,this.onCancel(e,t,i)}_onComplete(e,t,i){this.onComplete(e,t,i),this.uploader.options.removeAfterUpload&&this.remove()}_prepareToUploading(){this.index=this.index||++this.uploader._nextIndex,this.isReady=!0}},Pe=(()=>{class a{static{this.mime_doc=["application/msword","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.wordprocessingml.template","application/vnd.ms-word.document.macroEnabled.12","application/vnd.ms-word.template.macroEnabled.12"]}static{this.mime_xsl=["application/vnd.ms-excel","application/vnd.ms-excel","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.spreadsheetml.template","application/vnd.ms-excel.sheet.macroEnabled.12","application/vnd.ms-excel.template.macroEnabled.12","application/vnd.ms-excel.addin.macroEnabled.12","application/vnd.ms-excel.sheet.binary.macroEnabled.12"]}static{this.mime_ppt=["application/vnd.ms-powerpoint","application/vnd.ms-powerpoint","application/vnd.ms-powerpoint","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.presentationml.template","application/vnd.openxmlformats-officedocument.presentationml.slideshow","application/vnd.ms-powerpoint.addin.macroEnabled.12","application/vnd.ms-powerpoint.presentation.macroEnabled.12","application/vnd.ms-powerpoint.presentation.macroEnabled.12","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"]}static{this.mime_psd=["image/photoshop","image/x-photoshop","image/psd","application/photoshop","application/psd","zz-application/zz-winassoc-psd"]}static{this.mime_compress=["application/x-gtar","application/x-gcompress","application/compress","application/x-tar","application/x-rar-compressed","application/octet-stream","application/x-zip-compressed","application/zip-compressed","application/x-7z-compressed","application/gzip","application/x-bzip2"]}static getMimeClass(t){let i="application";return t?.type&&this.mime_psd.indexOf(t.type)!==-1||t?.type?.match("image.*")?i="image":t?.type?.match("video.*")?i="video":t?.type?.match("audio.*")?i="audio":t?.type==="application/pdf"?i="pdf":t?.type&&this.mime_compress.indexOf(t.type)!==-1?i="compress":t?.type&&this.mime_doc.indexOf(t.type)!==-1?i="doc":t?.type&&this.mime_xsl.indexOf(t.type)!==-1?i="xls":t?.type&&this.mime_ppt.indexOf(t.type)!==-1&&(i="ppt"),i==="application"&&t?.name&&(i=this.fileTypeDetection(t.name)),i}static fileTypeDetection(t){let i={jpg:"image",jpeg:"image",tif:"image",psd:"image",bmp:"image",png:"image",nef:"image",tiff:"image",cr2:"image",dwg:"image",cdr:"image",ai:"image",indd:"image",pin:"image",cdp:"image",skp:"image",stp:"image","3dm":"image",mp3:"audio",wav:"audio",wma:"audio",mod:"audio",m4a:"audio",compress:"compress",zip:"compress",rar:"compress","7z":"compress",lz:"compress",z01:"compress",bz2:"compress",gz:"compress",pdf:"pdf",xls:"xls",xlsx:"xls",ods:"xls",mp4:"video",avi:"video",wmv:"video",mpg:"video",mts:"video",flv:"video","3gp":"video",vob:"video",m4v:"video",mpeg:"video",m2ts:"video",mov:"video",doc:"doc",docx:"doc",eps:"doc",txt:"doc",odt:"doc",rtf:"doc",ppt:"ppt",pptx:"ppt",pps:"ppt",ppsx:"ppt",odp:"ppt"},n=t.split(".");if(n.length<2)return"application";let o=n[n.length-1].toLowerCase();return i[o]===void 0?"application":i[o]}}return a})();function Oe(a){return File&&a instanceof File}var q=class{constructor(e){this.isUploading=!1,this.queue=[],this.progress=0,this._nextIndex=0,this.options={autoUpload:!1,isHTML5:!0,filters:[],removeAfterUpload:!1,disableMultipart:!1,formatDataFunction:t=>t._file,formatDataFunctionIsAsync:!1,url:""},this.setOptions(e),this.response=new D}setOptions(e){this.options=Object.assign(this.options,e),this.authToken=this.options.authToken,this.authTokenHeader=this.options.authTokenHeader||"Authorization",this.autoUpload=this.options.autoUpload,this.options.filters?.unshift({name:"queueLimit",fn:this._queueLimitFilter}),this.options.maxFileSize&&this.options.filters?.unshift({name:"fileSize",fn:this._fileSizeFilter}),this.options.allowedFileType&&this.options.filters?.unshift({name:"fileType",fn:this._fileTypeFilter}),this.options.allowedMimeType&&this.options.filters?.unshift({name:"mimeType",fn:this._mimeTypeFilter});for(let t=0;t<this.queue.length;t++)this.queue[t].url=this.options.url}addToQueue(e,t,i){let n=t,o=[];for(let b of e)o.push(b);let p=this._getFilters(i),g=this.queue.length,v=[];o.map(b=>{n||(n=this.options);let W=new A(b);if(this._isValidFile(W,p,n)){let w=new R(this,b,n);v.push(w),this.queue.push(w),this._onAfterAddingFile(w)}else if(typeof this._failFilterIndex=="number"&&this._failFilterIndex>=0){let w=p[this._failFilterIndex];this._onWhenAddingFileFailed(W,w,n)}}),this.queue.length!==g&&(this._onAfterAddingAll(v),this.progress=this._getTotalProgress()),this._render(),this.options.autoUpload&&this.uploadAll()}removeFromQueue(e){let t=this.getIndexOfItem(e),i=this.queue[t];i.isUploading&&i.cancel(),this.queue.splice(t,1),this.progress=this._getTotalProgress()}clearQueue(){for(;this.queue.length;)this.queue[0].remove();this.progress=0}uploadItem(e){let t=this.getIndexOfItem(e),i=this.queue[t],n=this.options.isHTML5?"_xhrTransport":"_iframeTransport";i._prepareToUploading(),!this.isUploading&&(this.isUploading=!0,this[n](i))}cancelItem(e){let t=this.getIndexOfItem(e),i=this.queue[t],n=this.options.isHTML5?i._xhr:i._form;i&&i.isUploading&&n.abort()}uploadAll(){let e=this.getNotUploadedItems().filter(t=>!t.isUploading);e.length&&(e.map(t=>t._prepareToUploading()),e[0].upload())}cancelAll(){this.getNotUploadedItems().map(t=>t.cancel())}isFile(e){return Oe(e)}isFileLikeObject(e){return e instanceof A}getIndexOfItem(e){return typeof e=="number"?e:this.queue.indexOf(e)}getNotUploadedItems(){return this.queue.filter(e=>!e.isUploaded)}getReadyItems(){return this.queue.filter(e=>e.isReady&&!e.isUploading).sort((e,t)=>e.index-t.index)}onAfterAddingAll(e){return{fileItems:e}}onBuildItemForm(e,t){return{fileItem:e,form:t}}onAfterAddingFile(e){return{fileItem:e}}onWhenAddingFileFailed(e,t,i){return{item:e,filter:t,options:i}}onBeforeUploadItem(e){return{fileItem:e}}onProgressItem(e,t){return{fileItem:e,progress:t}}onProgressAll(e){return{progress:e}}onSuccessItem(e,t,i,n){return{item:e,response:t,status:i,headers:n}}onErrorItem(e,t,i,n){return{item:e,response:t,status:i,headers:n}}onCancelItem(e,t,i,n){return{item:e,response:t,status:i,headers:n}}onCompleteItem(e,t,i,n){return{item:e,response:t,status:i,headers:n}}onCompleteAll(){}_mimeTypeFilter(e){return!(e?.type&&this.options.allowedMimeType&&this.options.allowedMimeType?.indexOf(e.type)===-1)}_fileSizeFilter(e){return!(this.options.maxFileSize&&e.size>this.options.maxFileSize)}_fileTypeFilter(e){return!(this.options.allowedFileType&&this.options.allowedFileType.indexOf(Pe.getMimeClass(e))===-1)}_onErrorItem(e,t,i,n){e._onError(t,i,n),this.onErrorItem(e,t,i,n)}_onCompleteItem(e,t,i,n){e._onComplete(t,i,n),this.onCompleteItem(e,t,i,n);let o=this.getReadyItems()[0];if(this.isUploading=!1,o){o.upload();return}this.onCompleteAll(),this.progress=this._getTotalProgress(),this._render()}_headersGetter(e){return t=>t?e[t.toLowerCase()]||void 0:e}_xhrTransport(e){let t=this,i=e._xhr=new XMLHttpRequest,n;if(this._onBeforeUploadItem(e),typeof e._file.size!="number")throw new TypeError("The file specified is no longer valid");if(this.options.disableMultipart)this.options.formatDataFunction&&(n=this.options.formatDataFunction(e));else{n=new FormData,this._onBuildItemForm(e,n);let o=()=>n.append(e.alias,e._file,e.file.name);this.options.parametersBeforeFiles||o(),this.options.additionalParameter!==void 0&&Object.keys(this.options.additionalParameter).forEach(p=>{let g=this.options.additionalParameter?.[p];typeof g=="string"&&g.indexOf("{{file_name}}")>=0&&e.file?.name&&(g=g.replace("{{file_name}}",e.file.name)),n.append(p,g)}),o&&this.options.parametersBeforeFiles&&o()}if(i.upload.onprogress=o=>{let p=Math.round(o.lengthComputable?o.loaded*100/o.total:0);this._onProgressItem(e,p)},i.onload=()=>{let o=this._parseHeaders(i.getAllResponseHeaders()),p=this._transformResponse(i.response),v=`_on${this._isSuccessCode(i.status)?"Success":"Error"}Item`;this[v](e,p,i.status,o),this._onCompleteItem(e,p,i.status,o)},i.onerror=()=>{let o=this._parseHeaders(i.getAllResponseHeaders()),p=this._transformResponse(i.response);this._onErrorItem(e,p,i.status,o),this._onCompleteItem(e,p,i.status,o)},i.onabort=()=>{let o=this._parseHeaders(i.getAllResponseHeaders()),p=this._transformResponse(i.response);this._onCancelItem(e,p,i.status,o),this._onCompleteItem(e,p,i.status,o)},e.method&&e.url&&i.open(e.method,e.url,!0),i.withCredentials=e.withCredentials,this.options.headers)for(let o of this.options.headers)i.setRequestHeader(o.name,o.value);if(e.headers.length)for(let o of e.headers)i.setRequestHeader(o.name,o.value);this.authToken&&this.authTokenHeader&&i.setRequestHeader(this.authTokenHeader,this.authToken),i.onreadystatechange=function(){i.readyState==XMLHttpRequest.DONE&&t.response.emit(i.responseText)},this.options.formatDataFunctionIsAsync?n.then(o=>i.send(JSON.stringify(o))):i.send(n),this._render()}_getTotalProgress(e=0){if(this.options.removeAfterUpload)return e;let t=this.getNotUploadedItems().length,i=t?this.queue.length-t:this.queue.length,n=100/this.queue.length,o=e*n/100;return Math.round(i*n+o)}_getFilters(e){if(!e)return this.options?.filters||[];if(Array.isArray(e))return e;if(typeof e=="string"){let t=e.match(/[^\s,]+/g);return this.options?.filters||[].filter(i=>t?.indexOf(i.name)!==-1)}return this.options?.filters||[]}_render(){}_queueLimitFilter(){return this.options.queueLimit===void 0||this.queue.length<this.options.queueLimit}_isValidFile(e,t,i){return this._failFilterIndex=-1,t.length?t.every(n=>(typeof this._failFilterIndex=="number"&&this._failFilterIndex++,n.fn.call(this,e,i))):!0}_isSuccessCode(e){return e>=200&&e<300||e===304}_transformResponse(e){return e}_parseHeaders(e){let t={},i,n,o;return e&&e.split(`
`).map(p=>{o=p.indexOf(":"),i=p.slice(0,o).trim().toLowerCase(),n=p.slice(o+1).trim(),i&&(t[i]=t[i]?t[i]+", "+n:n)}),t}_onWhenAddingFileFailed(e,t,i){this.onWhenAddingFileFailed(e,t,i)}_onAfterAddingFile(e){this.onAfterAddingFile(e)}_onAfterAddingAll(e){this.onAfterAddingAll(e)}_onBeforeUploadItem(e){e._onBeforeUpload(),this.onBeforeUploadItem(e)}_onBuildItemForm(e,t){e._onBuildForm(t),this.onBuildItemForm(e,t)}_onProgressItem(e,t){let i=this._getTotalProgress(t);this.progress=i,e._onProgress(t),this.onProgressItem(e,t),this.onProgressAll(i),this._render()}_onSuccessItem(e,t,i,n){e._onSuccess(t,i,n),this.onSuccessItem(e,t,i,n)}_onCancelItem(e,t,i,n){e._onCancel(t,i,n),this.onCancelItem(e,t,i,n)}},Ue=(()=>{class a{constructor(t){this.fileOver=new D,this.onFileDrop=new D,this.element=t}getOptions(){return this.uploader?.options}getFilters(){return""}onDrop(t){let i=this._getTransfer(t);if(!i)return;let n=this.getOptions(),o=this.getFilters();this._preventAndStop(t),n&&this.uploader?.addToQueue(i.files,n,o),this.fileOver.emit(!1),this.onFileDrop.emit(i.files)}onDragOver(t){let i=this._getTransfer(t);this._haveFiles(i.types)&&(i.dropEffect="copy",this._preventAndStop(t),this.fileOver.emit(!0))}onDragLeave(t){this.element&&t.currentTarget===this.element[0]||(this._preventAndStop(t),this.fileOver.emit(!1))}_getTransfer(t){return t.dataTransfer?t.dataTransfer:t.originalEvent.dataTransfer}_preventAndStop(t){t.preventDefault(),t.stopPropagation()}_haveFiles(t){return t?t.indexOf?t.indexOf("Files")!==-1:t.contains?t.contains("Files"):!1:!1}static{this.\u0275fac=function(i){return new(i||a)(X(Z))}}static{this.\u0275dir=$({type:a,selectors:[["","ng2FileDrop",""]],hostBindings:function(i,n){i&1&&f("drop",function(p){return n.onDrop(p)})("dragover",function(p){return n.onDragOver(p)})("dragleave",function(p){return n.onDragLeave(p)})},inputs:{uploader:"uploader"},outputs:{fileOver:"fileOver",onFileDrop:"onFileDrop"},standalone:!1})}}return a})();var Ae=(()=>{class a{static{this.\u0275fac=function(i){return new(i||a)}}static{this.\u0275mod=K({type:a})}static{this.\u0275inj=Q({imports:[he]})}}return a})();var qe=a=>({"nv-file-over":a}),He=a=>({width:a}),ze=(a,e)=>e.id;function Ve(a,e){if(a&1){let t=I();r(0,"div",1),_(1,"img",7),r(2,"div",8)(3,"button",9),f("click",function(){let n=c(t).$implicit,o=m();return u(o.setMainPhoto(n))}),l(4,"Main"),s(),r(5,"button",10),f("click",function(){let n=c(t).$implicit,o=m();return u(o.deletePhoto(n))}),_(6,"i",11),s()()()}if(a&2){let t=e.$implicit;d(),T("src",t.url,P),d(2),h("disabled",t.isMain)("ngClass",t.isMain?"btn-success":"btn-outline-success"),d(2),h("disabled",t.isMain)}}function Le(a,e){if(a&1&&(r(0,"td",24),l(1),U(2,"number"),s()),a&2){let t=m().$implicit;d(),V("",ae(2,1,(t==null||t.file==null?null:t.file.size)/1024/1024,".2")," MB")}}function Ne(a,e){if(a&1&&(r(0,"tr")(1,"td")(2,"strong"),l(3),s()(),y(4,Le,3,4,"td",23),s()),a&2){let t=e.$implicit,i=m(2);d(3),C(t==null||t.file==null?null:t.file.name),d(),h("ngIf",i.uploader==null||i.uploader.options==null?null:i.uploader.options.isHTML5)}}function Re(a,e){if(a&1){let t=I();r(0,"div",12)(1,"h3"),l(2,"Upload queue"),s(),r(3,"p"),l(4),s(),r(5,"table",13)(6,"thead")(7,"tr")(8,"th",14),l(9,"Name"),s(),r(10,"th"),l(11,"Size"),s()()(),r(12,"tbody"),y(13,Ne,5,2,"tr",15),s()(),r(14,"div")(15,"div"),l(16," Queue progress: "),r(17,"div",16),_(18,"div",17),s()(),r(19,"button",18),f("click",function(){c(t);let n=m();return u(n.uploader==null?null:n.uploader.uploadAll())}),_(20,"span",19),l(21," Upload all "),s(),r(22,"button",20),f("click",function(){c(t);let n=m();return u(n.uploader==null?null:n.uploader.cancelAll())}),_(23,"span",21),l(24," Cancel all "),s(),r(25,"button",22),f("click",function(){c(t);let n=m();return u(n.uploader==null?null:n.uploader.clearQueue())}),_(26,"span",11),l(27," Remove all "),s()()()}if(a&2){let t,i=m();d(4),V("Queue length: ",i.uploader==null||i.uploader.queue==null?null:i.uploader.queue.length,""),d(9),h("ngForOf",i.uploader==null?null:i.uploader.queue),d(5),h("ngStyle",L(6,He,(i.uploader==null?null:i.uploader.progress)+"%")),d(),h("disabled",!(!(i.uploader==null||(t=i.uploader.getNotUploadedItems())==null)&&t.length)),d(3),h("disabled",!(i.uploader!=null&&i.uploader.isUploading)),d(3),h("disabled",!(!(i.uploader==null||i.uploader.queue==null)&&i.uploader.queue.length))}}var H=class a{member=G.required();memberChange=j();uploader;hasBaseDropZoneOver=!1;baseUrl=be.apiUrl;accountService=x(B);memberService=x(k);ngOnInit(){this.initializeUploader()}fileOverBase(e){this.hasBaseDropZoneOver=e}setMainPhoto(e){this.memberService.setMainPhoto(e).subscribe({next:t=>{let i=this.accountService.currentUser();i&&(i.photoUrl=e.url,this.accountService.setCurrentUser(i));let n=E({},this.member());n.photoUrl=e.url,n.photos.forEach(o=>{o.isMain&&(o.isMain=!1),o.id===e.id&&(o.isMain=!0)}),this.memberChange.emit(n)}})}initializeUploader(){this.uploader=new q({url:`${this.baseUrl}/users/add-photo`,authToken:"Bearer "+this.accountService.currentUser()?.token,isHTML5:!0,autoUpload:!1,removeAfterUpload:!0,maxFileSize:10*1024*1024}),this.uploader.onAfterAddingFile=e=>{e.withCredentials=!1},this.uploader.onSuccessItem=(e,t,i,n)=>{if(t){let o=JSON.parse(t),p=E({},this.member());if(p.photos.push(o),this.memberChange.emit(p),o.isMain){let g=this.accountService.currentUser();g&&(g.photoUrl=o.url,this.accountService.setCurrentUser(g));let v=E({},this.member());v.photoUrl=o.url,v.photos.forEach(b=>{b.isMain&&(b.isMain=!1),b.id===o.id&&(b.isMain=!0)}),this.memberChange.emit(v)}}}}deletePhoto(e){this.memberService.deletePhoto(e).subscribe({next:t=>{let i=E({},this.member());i.photos=i.photos.filter(n=>n.id!==e.id),this.memberChange.emit(i)}})}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=O({type:a,selectors:[["app-photo-editor"]],inputs:{member:[1,"member"]},outputs:{memberChange:"memberChange"},decls:11,vars:5,consts:[[1,"row"],[1,"col-md-2"],[1,"row","mt-4"],[1,"col-md-3"],["ng2FileDrop","",1,"card","bg-faded","p-4","text-center","my-drop-zone",3,"fileOver","ngClass","uploader"],[1,"fa","fa-upload","fa-3x"],["class","col-md-9","style","margin-bottom: 40px",4,"ngIf"],["alt","photo of user",1,"img-thumbnail",3,"src"],[1,"text-center"],[1,"btn","btn-sm",3,"click","disabled","ngClass"],[1,"btn","btn-sm","btn-danger",3,"click","disabled"],[1,"fa","fa-trash"],[1,"col-md-9",2,"margin-bottom","40px"],[1,"table"],["width","50%"],[4,"ngFor","ngForOf"],[1,"progress"],["role","progressbar",1,"progress-bar",3,"ngStyle"],["type","button",1,"btn","btn-success","btn-s",3,"click","disabled"],[1,"fa","fa-upload"],["type","button",1,"btn","btn-warning","btn-s",3,"click","disabled"],[1,"fa","fa-ban"],["type","button",1,"btn","btn-danger","btn-s",3,"click","disabled"],["nowrap","",4,"ngIf"],["nowrap",""]],template:function(t,i){t&1&&(r(0,"div",0),ee(1,Ve,7,4,"div",1,ze),s(),r(3,"div",2)(4,"div",3)(5,"h3"),l(6,"Add Photos"),s(),r(7,"div",4),f("fileOver",function(o){return i.fileOverBase(o)}),_(8,"i",5),l(9," Drop photos here "),s()(),y(10,Re,28,8,"div",6),s()),t&2&&(d(),te(i.member().photos),d(6),h("ngClass",L(3,qe,i.hasBaseDropZoneOver))("uploader",i.uploader),d(3),h("ngIf",i.uploader==null||i.uploader.queue==null?null:i.uploader.queue.length))},dependencies:[de,pe,me,le,Ae,Ue,ue],styles:[".nv-file-over[_ngcontent-%COMP%]{border:dotted 3px red}"]})};var We=["editForm"];function Qe(a,e){a&1&&(r(0,"div",5)(1,"p")(2,"strong"),l(3,"Information:"),s(),l(4," You have made changes. Any unsaved changes will be lost"),s()())}function je(a,e){if(a&1){let t=I();r(0,"div",1)(1,"div",2)(2,"h1",3),l(3,"Your profile"),s()(),r(4,"div",4),y(5,Qe,5,0,"div",5),s(),r(6,"div",2)(7,"div",6),_(8,"img",7),r(9,"div",8)(10,"div")(11,"strong"),l(12,"Location:"),s(),r(13,"p"),l(14),s()(),r(15,"div")(16,"strong"),l(17,"Age:"),s(),r(18,"p"),l(19),s()(),r(20,"div")(21,"strong"),l(22,"Last Active:"),s(),r(23,"p"),l(24),U(25,"timeago"),s()(),r(26,"div")(27,"strong"),l(28,"Member since:"),s(),r(29,"p"),l(30),U(31,"date"),s()()(),r(32,"div",9)(33,"button",10),l(34,"Save changes"),s()()()(),r(35,"div",11)(36,"tabset",12)(37,"tab",13)(38,"form",14,0),f("ngSubmit",function(){c(t);let n=m();return u(n.updateMember())}),r(40,"h4",15),l(41,"Description"),s(),r(42,"textarea",16),M("ngModelChange",function(n){c(t);let o=m();return S(o.member.introduction,n)||(o.member.introduction=n),u(n)}),s(),r(43,"h4",15),l(44,"Looking for"),s(),r(45,"textarea",17),M("ngModelChange",function(n){c(t);let o=m();return S(o.member.lookingFor,n)||(o.member.lookingFor=n),u(n)}),s(),r(46,"h4",15),l(47,"Interests"),s(),r(48,"textarea",18),M("ngModelChange",function(n){c(t);let o=m();return S(o.member.interests,n)||(o.member.interests=n),u(n)}),s(),r(49,"h4",15),l(50,"Location Details"),s(),r(51,"div",19)(52,"label",20),l(53,"City: "),s(),r(54,"input",21),M("ngModelChange",function(n){c(t);let o=m();return S(o.member.city,n)||(o.member.city=n),u(n)}),s(),r(55,"label",22),l(56,"Country: "),s(),r(57,"input",23),M("ngModelChange",function(n){c(t);let o=m();return S(o.member.country,n)||(o.member.country=n),u(n)}),s()()()(),r(58,"tab",24)(59,"app-photo-editor",25),f("memberChange",function(n){c(t);let o=m();return u(o.onMemberChange(n))}),s()()()()()}if(a&2){let t=re(39),i=m();d(5),z(t.dirty?5:-1),d(3),T("src",i.member.photoUrl||"./assets/user.png",P),T("alt",i.member.knownAs),d(6),se("",i.member.city,", ",i.member.country,""),d(5),C(i.member.age),d(5),C(N(25,17,i.member.lastActive)),d(6),C(N(31,19,i.member.created)),d(3),h("disabled",!t.dirty),d(4),ie("heading","About ",i.member.knownAs,""),d(5),F("ngModel",i.member.introduction),d(3),F("ngModel",i.member.lookingFor),d(3),F("ngModel",i.member.interests),d(6),F("ngModel",i.member.city),d(3),F("ngModel",i.member.country),d(2),h("member",i.member)}}var De=class a{editForm=Y("editForm");notify(e){this.editForm()?.dirty&&(e.returnValue=!0)}member;images=[];accountService=x(B);memberService=x(k);toaster=x(_e);ngOnInit(){this.loadMember()}loadMember(){let e=this.accountService.currentUser();e&&this.memberService.getMember(e.username).subscribe({next:t=>this.member=t})}updateMember(){this.member&&this.memberService.updateMember(this.editForm()?.value).subscribe({next:e=>{this.toaster.success("Profile updated successfully"),this.editForm()?.reset(this.member)}})}onMemberChange(e){this.member=e,this.loadMember()}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=O({type:a,selectors:[["app-member-edit"]],viewQuery:function(t,i){t&1&&ne(i.editForm,We,5),t&2&&oe()},hostBindings:function(t,i){t&1&&f("beforeunload",function(o){return i.notify(o)},!1,J)},decls:1,vars:1,consts:[["editForm","ngForm"],[1,"row"],[1,"col-md-4"],[1,"text-muted"],[1,"col-md-8"],[1,"alert","alert-info","py-0","pt-2"],[1,"card"],[1,"card-img","img-thumbnail","mx-auto",3,"src","alt"],[1,"card-body"],[1,"card-footer"],["form","editForm","type","submit",1,"btn","btn-success","col-md-12",3,"disabled"],[1,"col-md-8","mt-1"],[1,"member-tabset"],[3,"heading"],["id","editForm",3,"ngSubmit"],[1,"mt-2"],["name","introduction","rows","6",1,"form-control",3,"ngModelChange","ngModel"],["name","lookingFor","rows","6",1,"form-control",3,"ngModelChange","ngModel"],["name","interests","rows","6",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","align-items-center"],["for","city"],["id","city","type","text","name","city",1,"form-control","mx-2",3,"ngModelChange","ngModel"],["for","country"],["id","country","type","text","name","country",1,"form-control","mx-2",3,"ngModelChange","ngModel"],["heading","Edit photos"],[3,"memberChange","member"]],template:function(t,i){t&1&&y(0,je,60,21,"div",1),t&2&&z(i.member?0:-1)},dependencies:[Ie,Ee,we,Me,Se,ve,xe,ye,Fe,Ce,H,ce,ge,fe],styles:[".img-thumbnail[_ngcontent-%COMP%]{margin:25px;width:85%;height:85%}.card-body[_ngcontent-%COMP%]{padding:0 25px}.card-footer[_ngcontent-%COMP%]{padding:10px 15px;border-top:none}"]})};export{De as MemberEditComponent};
