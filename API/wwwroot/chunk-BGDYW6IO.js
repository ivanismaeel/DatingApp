import{a as M,b as A,d as j}from"./chunk-TQ44ZZAZ.js";import"./chunk-LZYVH2VE.js";import{a as $,b as N,c as H}from"./chunk-3FYXDXPB.js";import"./chunk-FBW7R5MW.js";import"./chunk-IQ3DILG5.js";import"./chunk-7W5VCNUX.js";import{c as F}from"./chunk-K5ZT4YFK.js";import"./chunk-TRHVLWE7.js";import{$b as s,Db as P,Eb as v,Fb as R,Gb as o,Hb as i,Ib as u,Mb as C,Ob as c,Pb as h,Wc as I,ac as f,cb as l,ea as T,hc as k,ka as p,nb as r,ra as b,sa as g,sb as D,yb as d}from"./chunk-FY6FPK4F.js";var _=class n{baseUrl=F.apiUrl;url=`${this.baseUrl}/admin`;http=p(I);getUserWithRoles(){return this.http.get(`${this.url}/users-with-roles`)}updateUserRoles(t,e){return this.http.post(`${this.url}/edit-roles/${t}?roles=${e}`,{})}static \u0275fac=function(e){return new(e||n)};static \u0275prov=T({token:n,factory:n.\u0275fac,providedIn:"root"})};function V(n,t){if(n&1){let e=C();o(0,"div",5)(1,"input",8),c("change",function(){let m=b(e).$implicit,E=h();return g(E.updateChecked(m))}),i(),o(2,"label"),s(3),i()()}if(n&2){let e=t.$implicit,a=h();l(),d("checked",a.selectedRoles.includes(e))("disabled",e==="Admin"&&a.username==="admin"),l(2),f(e)}}var y=class n{bsModalRef=p(M);username="";title="";rolesUpdated=!1;availableRoles=[];selectedRoles=[];updateChecked(t){this.selectedRoles.includes(t)?this.selectedRoles=this.selectedRoles.filter(e=>e!==t):this.selectedRoles.push(t)}onSelectedRoles(){this.rolesUpdated=!0,this.bsModalRef.hide()}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=r({type:n,selectors:[["app-roles-modal"]],decls:13,vars:2,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],["type","button",1,"btn-close","close","pull-left",3,"click"],[1,"visually-hidden"],[1,"modal-body"],[1,"form-check"],[1,"modal-footer"],["type","button",1,"btn","btn-success",3,"click","disabled"],["type","checkbox","value","role",1,"form-check-input",3,"change","checked","disabled"]],template:function(e,a){e&1&&(o(0,"div",0)(1,"h4",1),s(2),i(),o(3,"button",2),c("click",function(){return a.bsModalRef.hide()}),o(4,"span",3),s(5,"\xD7"),i()()(),o(6,"div",4)(7,"ul"),v(8,V,4,3,"div",5,P),i()(),o(10,"div",6)(11,"button",7),c("click",function(){return a.onSelectedRoles()}),s(12,"Submit"),i()()),e&2&&(l(2),f(a.title),l(6),R(a.availableRoles),l(3),d("disabled",a.selectedRoles.length===0))},encapsulation:2})};var W=(n,t)=>t.username;function O(n,t){if(n&1){let e=C();o(0,"tr")(1,"td"),s(2),i(),o(3,"td"),s(4),i(),o(5,"td")(6,"button",4),c("click",function(){let m=b(e).$implicit,E=h();return g(E.openRolesModal(m))}),s(7,"Edit roles"),i()()()}if(n&2){let e=t.$implicit;l(2),f(e.username),l(2),f(e.roles)}}var S=class n{adminService=p(_);modalService=p(A);users=[];bsModalRef=new M;ngOnInit(){this.getUsersWithRoles()}openRolesModal(t){let e={class:"modal-lg",initialState:{title:"User roles",username:t.username,selectedRoles:[...t.roles],availableRoles:["Admin","Moderator","Member"],users:this.users,rolesUpdated:!1}};this.bsModalRef=this.modalService.show(y,e),this.bsModalRef.onHide?.subscribe({next:()=>{if(this.bsModalRef?.content?.rolesUpdated){let a=this.bsModalRef.content.selectedRoles;this.adminService.updateUserRoles(t.username,a).subscribe({next:m=>t.roles=m})}}})}getUsersWithRoles(){this.adminService.getUserWithRoles().subscribe({next:t=>this.users=t})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=r({type:n,selectors:[["app-user-management"]],decls:12,vars:0,consts:[[1,"row"],[1,"table"],[2,"width","30%"],[2,"width","40%"],[1,"btn","btn-info",3,"click"]],template:function(e,a){e&1&&(o(0,"div",0)(1,"table",1)(2,"thead")(3,"tr")(4,"th",2),s(5,"Username"),i(),o(6,"th",3),s(7,"Active roles"),i(),u(8,"th",2),i()(),o(9,"tbody"),v(10,O,8,2,"tr",null,W),i()()()),e&2&&(l(10),R(a.users))},encapsulation:2})};var U=class n{static \u0275fac=function(e){return new(e||n)};static \u0275cmp=r({type:n,selectors:[["app-photo-management"]],decls:2,vars:0,template:function(e,a){e&1&&(o(0,"p"),s(1,"photo-management works!"),i())},encapsulation:2})};var q=()=>["Admin"],z=()=>["Admin","Moderator"];function G(n,t){n&1&&(o(0,"tab",4)(1,"div",5),u(2,"app-user-management"),i()())}function J(n,t){n&1&&(o(0,"tab",6)(1,"div",5),u(2,"app-photo-management"),i()())}var B=class n{static \u0275fac=function(e){return new(e||n)};static \u0275cmp=r({type:n,selectors:[["app-admin-panel"]],decls:6,vars:4,consts:[[1,"tab-panel"],[1,"member-tabset"],["heading","User management",4,"appHasRole"],["heading","Photo management",4,"appHasRole"],["heading","User management"],[1,"container"],["heading","Photo management"]],template:function(e,a){e&1&&(o(0,"h2"),s(1,"Admin panel"),i(),o(2,"div",0)(3,"tabset",1),D(4,G,3,0,"tab",2)(5,J,3,0,"tab",3),i()()),e&2&&(l(4),d("appHasRole",k(2,q)),l(),d("appHasRole",k(3,z)))},dependencies:[H,N,$,j,S,U],encapsulation:2})};export{B as AdminPanelComponent};
