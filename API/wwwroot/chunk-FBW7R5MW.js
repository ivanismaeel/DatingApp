import{a as m}from"./chunk-IQ3DILG5.js";import{o as l,p}from"./chunk-7W5VCNUX.js";import{A as o,Ea as n,Wc as a,ea as s,ka as t,xc as c}from"./chunk-FY6FPK4F.js";var u=class i{http=t(a);likesService=t(p);presenceService=t(l);baseUrl=m.apiUrl;currentUser=n(null);roles=c(()=>{let r=this.currentUser();if(!r)return[];let e=JSON.parse(atob(r.token.split(".")[1])).role;return Array.isArray(e)?e:[e]});login(r){return this.http.post(`${this.baseUrl}/account/login`,r).pipe(o(e=>{e&&this.setCurrentUser(e)}))}register(r){return this.http.post(`${this.baseUrl}/account/register`,r).pipe(o(e=>(e&&this.setCurrentUser(e),e)))}setCurrentUser(r){localStorage.setItem("user",JSON.stringify(r)),this.currentUser.set(r),this.likesService.getLikeIds(),this.presenceService.createHubConnection(r)}logout(){localStorage.removeItem("user"),this.currentUser.set(null),this.presenceService.stopHubConnection()}static \u0275fac=function(e){return new(e||i)};static \u0275prov=s({token:i,factory:i.\u0275fac,providedIn:"root"})};export{u as a};
