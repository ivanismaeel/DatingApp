import{a as A}from"./chunk-GQNIFM5P.js";import{a as V,b as L}from"./chunk-Y2SMNW46.js";import{a as z,b as D,c as j,d as q}from"./chunk-O35JHE6I.js";import{f as N,j as U,v as F}from"./chunk-EHQ3Q2RR.js";import"./chunk-K5ZT4YFK.js";import{g as R}from"./chunk-TRHVLWE7.js";import{$b as l,Cb as b,Eb as v,Fb as T,Gb as a,Hb as s,Ib as k,Mb as f,Ob as d,Pb as g,Sb as E,_a as S,ac as x,bc as I,cb as m,dc as _,ec as M,fc as C,hc as W,ka as y,lc as B,mc as O,nb as w,ra as p,sa as c,sb as P,yb as u}from"./chunk-FY6FPK4F.js";var H=()=>({tab:"Messages"}),J=(r,o)=>o.id;function K(r,o){r&1&&(a(0,"h3",6),l(1,"No messages"),s())}function Q(r,o){if(r&1){let n=f();a(0,"tr",12)(1,"td",13),l(2),s(),a(3,"td")(4,"div",14),k(5,"img",15),a(6,"strong",13),l(7),s()()(),a(8,"td",13),l(9),B(10,"timeago"),s(),a(11,"td")(12,"button",16),d("click",function(i){return p(n),c(i.stopPropagation())})("click",function(){let i=p(n).$implicit,t=g(2);return c(t.deleteMessage(i.id))}),l(13,"Delete"),s()()()}if(r&2){let n=o.$implicit,e=g(2);E("routerLink",e.getRoute(n)),u("queryParams",W(8,H)),m(2),x(n.content),m(3),u("src",e.isOutbox?n.recipientPhotoUrl||"assets/user.png":n.senderPhotoUrl||"assets/user.png",S),m(2),x(e.isOutbox?n.recipientUsername:n.senderUsername),m(2),I("",O(10,6,n.messageSent)," ")}}function X(r,o){if(r&1&&(a(0,"table",7)(1,"thead")(2,"tr")(3,"th",9),l(4,"Message"),s(),a(5,"th",10),l(6,"From / To"),s(),a(7,"th",10),l(8,"Sent / Received"),s(),a(9,"th",10),l(10,"Message"),s()()(),a(11,"tbody",11),v(12,Q,14,9,"tr",12,J),s()()),r&2){let n,e=g();m(12),T((n=e.messages())==null?null:n.items)}}function Y(r,o){if(r&1){let n=f();a(0,"div",8)(1,"pagination",17),C("ngModelChange",function(i){let t;p(n);let h=g();return M((t=h.messages())==null?null:t.pagination.currentPage,i)||(((t=h.messages())==null?null:t.pagination).currentPage=i),c(i)}),d("pageChanged",function(i){p(n);let t=g();return c(t.pageChanged(i))}),s()()}if(r&2){let n,e,i,t=g();m(),u("boundaryLinks",!0),_("ngModel",(n=t.messages())==null?null:n.pagination.currentPage),u("totalItems",(e=t.messages())==null?null:e.pagination.totalItems)("itemsPerPage",(i=t.messages())==null?null:i.pagination.itemsPerPage)("maxSize",5)}}var G=class r{messageService=y(A);messages=this.messageService.paginatedResponse;container="Inbox";pageNumber=1;pageSize=5;isOutbox=this.container==="Outbox";ngOnInit(){this.loadMessages()}loadMessages(){this.messageService.getMessages(this.container,this.pageNumber,this.pageSize)}deleteMessage(o){this.messageService.deleteMessage(o).subscribe({next:()=>{this.messageService.paginatedResponse.update(n=>(n?.items?.splice(n.items.findIndex(e=>e.id===o),1),n))}})}getRoute(o){return this.container==="Outbox"?`/members/${o.recipientUsername}`:`/members/${o.senderUsername}`}pageChanged(o){o.page!==this.pageNumber&&(this.pageNumber=o.page,this.loadMessages())}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=w({type:r,selectors:[["app-messages"]],decls:12,vars:5,consts:[[1,"container","mt-3"],[1,"d-flex"],[1,"btn-group"],["btnRadio","Unread",1,"btn","btn-primary",3,"ngModelChange","click","ngModel"],["btnRadio","Inbox",1,"btn","btn-primary",3,"ngModelChange","click","ngModel"],["btnRadio","Outbox",1,"btn","btn-primary",3,"ngModelChange","click","ngModel"],[1,"mt-3"],[1,"table","table-hover","mt-3",2,"cursor","pointer"],[1,"d-flex","justify-content-center"],[1,"text-muted",2,"width","40%"],[1,"text-muted",2,"width","20%"],[1,"align-middle"],[3,"routerLink","queryParams"],[1,"text-muted"],[1,""],["alt","img of user",1,"rounded-circle","me-2",3,"src"],[1,"btn","btn-danger",3,"click"],["previousText","\u2039","nextText","\u203A","firstText","\xAB","lastText","\xBB",3,"ngModelChange","pageChanged","boundaryLinks","ngModel","totalItems","itemsPerPage","maxSize"]],template:function(n,e){if(n&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),C("ngModelChange",function(t){return M(e.container,t)||(e.container=t),t}),d("click",function(){return e.loadMessages()}),l(4,"Unread"),s(),a(5,"button",4),C("ngModelChange",function(t){return M(e.container,t)||(e.container=t),t}),d("click",function(){return e.loadMessages()}),l(6,"Inbox"),s(),a(7,"button",5),C("ngModelChange",function(t){return M(e.container,t)||(e.container=t),t}),d("click",function(){return e.loadMessages()}),l(8,"Outbox"),s()()()(),P(9,K,2,0,"h3",6)(10,X,14,0,"table",7)(11,Y,2,5,"div",8)),n&2){let i,t;m(3),_("ngModel",e.container),m(2),_("ngModel",e.container),m(2),_("ngModel",e.container),m(2),b(!((i=e.messages())!=null&&i.items)||((i=e.messages())==null||i.items==null?null:i.items.length)===0?9:10),m(2),b((t=e.messages())!=null&&t.pagination&&((t=e.messages())==null||t.pagination==null?null:t.pagination.totalItems)>0?11:-1)}},dependencies:[F,N,U,D,z,L,V,R,q,j],styles:[".rounded-circle[_ngcontent-%COMP%]{max-width:50px}table[_ngcontent-%COMP%]{color:#dad5d5!important}"]})};export{G as MessagesComponent};
